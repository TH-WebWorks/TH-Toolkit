<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Creative Brief Wizard - Streamlined consultation process for T&H WebWorks">
    <meta name="robots" content="noindex, nofollow">
    <title>Creative Brief Wizard - T&H WebWorks</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* === MODERN DESIGN SYSTEM === */
        :root {
            --primary: #3abbfa;
            --primary-dark: #2a9ee0;
            --primary-light: #5ac8ff;
            --secondary: #f39c12;
            --accent: #2ecc71;
            --dark: #1b1e24;
            --dark-light: #2b2f35;
            --dark-lighter: #3a3f47;
            --text: #ffffff;
            --text-muted: #a0a0a0;
            --border: #4a4f57;
            --success: #27ae60;
            --warning: #f39c12;
            --error: #e74c3c;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* === AUTH OVERLAY === */
        .auth-overlay {
            background: linear-gradient(135deg, var(--dark) 0%, #2d3748 100%);
            backdrop-filter: blur(10px);
        }

        .auth-card {
            background: rgba(43, 47, 53, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-xl);
            border-radius: var(--radius-xl);
        }

        .auth-input {
            background: rgba(26, 30, 36, 0.8);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            transition: all 0.3s ease;
            font-size: 1.5rem;
            letter-spacing: 0.5rem;
        }

        .auth-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(58, 187, 250, 0.1);
            transform: translateY(-2px);
        }

        .auth-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: var(--radius);
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .auth-btn:hover::before {
            left: 100%;
        }

        /* === MAIN LAYOUT === */
        .main-container {
            background: linear-gradient(135deg, var(--dark) 0%, #2d3748 100%);
            min-height: 100vh;
        }

        .form-panel {
            background: rgba(43, 47, 53, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
        }

        .preview-panel {
            background: rgba(26, 30, 36, 0.8);
            backdrop-filter: blur(10px);
            border-left: 1px solid var(--border);
        }

        /* === PROGRESS BAR === */
        .progress-container {
            background: rgba(26, 30, 36, 0.8);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        .progress-bar {
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: var(--radius);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: progressShimmer 2s infinite;
        }

        /* === FORM ELEMENTS === */
        .form-step {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .form-step.active {
            opacity: 1;
            transform: translateY(0);
        }

        .step-title {
            font-size: 1.875rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .step-description {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-bottom: 2rem;
            line-height: 1.7;
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-label {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.75rem;
            display: block;
            font-size: 1.1rem;
        }

        .form-description {
            color: var(--text-muted);
            font-size: 0.95rem;
            margin-bottom: 1rem;
        }

        /* === INPUT STYLES === */
        .input-group {
            display: grid;
            gap: 1rem;
        }

        .input-group.grid-cols-1 {
            grid-template-columns: 1fr;
        }

        .input-group.grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .input-group.md\\:grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        @media (max-width: 768px) {
            .input-group.grid-cols-2,
            .input-group.md\\:grid-cols-3 {
                grid-template-columns: 1fr;
            }
        }

        .input-option {
            background: rgba(26, 30, 36, 0.8);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .input-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .input-option.selected {
            border-color: var(--primary);
            background: rgba(58, 187, 250, 0.1);
            box-shadow: 0 0 0 3px rgba(58, 187, 250, 0.1);
        }

        .input-option input[type="radio"],
        .input-option input[type="checkbox"] {
            position: absolute;
            opacity: 0;
        }

        .input-option input[type="text"],
        .input-option input[type="email"],
        .input-option input[type="tel"],
        .input-option select,
        .input-option textarea {
            background: transparent;
            border: none;
            outline: none;
            width: 100%;
            color: var(--text);
            font-size: 1rem;
            padding: 0;
        }

        .input-option input[type="text"]::placeholder,
        .input-option input[type="email"]::placeholder,
        .input-option input[type="tel"]::placeholder,
        .input-option textarea::placeholder {
            color: var(--text-muted);
        }

        /* Fix for select dropdowns */
        .input-option select {
            cursor: pointer;
        }

        .input-option select option {
            background: var(--dark-light);
            color: var(--text);
        }

        .option-label {
            font-weight: 500;
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .option-icon {
            width: 2rem;
            height: 2rem;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }

        /* === BUTTONS === */
        .btn {
            padding: 0.875rem 2rem;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: rgba(26, 30, 36, 0.8);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            background: rgba(58, 187, 250, 0.1);
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            justify-content: space-between;
            margin-top: 2rem;
        }

        /* === PREVIEW PANEL === */
        .preview-header {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-dots {
            display: flex;
            gap: 0.25rem;
        }

        .preview-dot {
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
        }

        .preview-dot.red { background: #ff5f56; }
        .preview-dot.yellow { background: #ffbd2e; }
        .preview-dot.green { background: #27ca3f; }

        .site-preview {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            transition: all 0.3s ease;
        }

        .preview-content {
            padding: 1.5rem;
            min-height: 400px;
            transition: all 0.3s ease;
        }

        .preview-placeholder {
            background: linear-gradient(45deg, #f8f9fa 25%, transparent 25%), 
                        linear-gradient(-45deg, #f8f9fa 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, #f8f9fa 75%), 
                        linear-gradient(-45deg, transparent 75%, #f8f9fa 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            font-size: 1rem;
            border-radius: var(--radius);
        }

        .preview-info {
            background: rgba(43, 47, 53, 0.95);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        /* === ANIMATIONS === */
        @keyframes progressShimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(58, 187, 250, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(58, 187, 250, 0); }
            100% { box-shadow: 0 0 0 0 rgba(58, 187, 250, 0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(-20px); }
        }

        @keyframes shimmer {
            0% { background-position: 0 0, 0 10px, 10px -10px, -10px 0px; }
            100% { background-position: 40px 40px, 40px 50px, 50px 30px, 30px 40px; }
        }

        /* === RESPONSIVE === */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
            }
            
            .preview-panel {
                border-left: none;
                border-top: 1px solid var(--border);
            }
        }

        @media (max-width: 768px) {
            .btn-group {
                flex-direction: column;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
            
            .step-title {
                font-size: 1.5rem;
            }
        }

        /* === UTILITY CLASSES === */
        .text-gradient {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .shadow-glow {
            box-shadow: 0 0 20px rgba(58, 187, 250, 0.3);
        }

        /* === ADDITIONAL ENHANCEMENTS === */
        .form-group.text-center {
            text-align: center;
        }

        .form-group.text-center img {
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
        }

        .text-primary {
            color: var(--primary);
        }

        .text-primary-light {
            color: var(--primary-light);
        }

        .text-error {
            color: var(--error);
        }

        .text-text-muted {
            color: var(--text-muted);
        }

        /* === FOCUS STATES === */
        .input-option:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(58, 187, 250, 0.1);
        }

        /* === SELECTION INDICATORS === */
        .input-option.selected::before {
            content: '‚úì';
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: var(--primary);
            color: white;
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
        }

        /* === LOADING STATES === */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 1rem;
            height: 1rem;
            border: 2px solid var(--border);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body class="main-container">
    <!-- PIN Authentication Overlay -->
    <div id="authOverlay" class="auth-overlay fixed inset-0 z-50 flex items-center justify-center">
        <div class="auth-card p-8 max-w-md w-full mx-4">
            <div class="text-center mb-8">
                <img src="Images/THLogo_trans.webp" alt="T&H WebWorks Logo" class="h-20 mx-auto mb-6">
                <h2 class="text-3xl font-bold text-gradient mb-3">Creative Brief Wizard</h2>
                <p class="text-text-muted text-lg">Enter PIN to access</p>
            </div>
            
            <form id="pinForm" class="space-y-6">
                <div class="relative">
                    <input type="password" id="pinInput" maxlength="4" placeholder="Enter 4-digit PIN" 
                           class="auth-input w-full p-6 text-center text-3xl font-mono text-white">
                </div>
                
                <div id="pinError" class="text-error text-sm text-center hidden">
                    Incorrect PIN. Please try again.
                </div>
                
                <button type="submit" class="auth-btn w-full py-4 px-8 text-white text-lg">
                    Access Wizard
                </button>
            </form>
            
            <div class="mt-8 text-center">
                <p class="text-text-muted text-sm">For T&H WebWorks team use only</p>
                <a href="index.html" class="text-primary hover:text-primary-light text-sm mt-3 inline-block transition-colors">
                    ‚Üê Back to Toolkit
                </a>
            </div>
        </div>
    </div>

    <!-- Main Content (hidden until authenticated) -->
    <div id="mainContent" class="hidden">
        <main class="flex flex-col lg:flex-row min-h-screen">
            <!-- Form Panel -->
            <div class="flex-1 flex flex-col items-center justify-center py-12 px-6">
                <div class="form-panel w-full max-w-3xl p-8 md:p-10 relative">
                <!-- Progress Bar -->
                    <div class="progress-container">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-sm font-semibold text-primary">Step <span id="progressStep">1</span> of <span id="progressTotal">8</span></span>
                            <span class="text-sm text-text-muted" id="progressLabel">Welcome</span>
                    </div>
                        <div class="w-full h-3 bg-dark-lighter rounded-full overflow-hidden">
                            <div id="progressBar" class="progress-bar h-3 transition-all duration-500" style="width: 12.5%"></div>
                    </div>
                </div>
                <!-- Dynamic Form -->
                <form id="wizardForm" class="space-y-8"></form>
            </div>
            </div>

            <!-- Live Preview Panel -->
            <div id="previewPanel" class="preview-panel w-full lg:w-1/2 p-8">
                <div class="sticky top-8">
                    <h3 class="text-xl font-semibold text-white mb-6 flex items-center">
                        <span class="text-primary mr-3">üëÅÔ∏è</span>
                        Live Preview
                    </h3>
                    <div id="sitePreview" class="site-preview">
                        <div class="preview-header">
                            <div class="preview-dots">
                                <div class="preview-dot red"></div>
                                <div class="preview-dot yellow"></div>
                                <div class="preview-dot green"></div>
                            </div>
                            <span class="text-xs text-gray-600 ml-3">example.com</span>
                        </div>
                        <div class="preview-content">
                            <div class="preview-placeholder">
                                <div class="text-center">
                                    <div class="text-6xl mb-4">üé®</div>
                                    <div class="text-lg font-medium">Start building your site</div>
                                    <div class="text-sm text-gray-500 mt-2">Select your business type to begin</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preview Info -->
                    <div id="previewInfo" class="preview-info">
                        <h4 class="font-semibold text-primary mb-3 text-lg">Site Configuration</h4>
                        <div id="previewDetails" class="text-sm text-text-muted space-y-2">
                            <p>Select options to see your site configuration</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // PIN Authentication System
        const CORRECT_PIN = '1234';
        const authOverlay = document.getElementById('authOverlay');
        const mainContent = document.getElementById('mainContent');
        const pinForm = document.getElementById('pinForm');
        const pinInput = document.getElementById('pinInput');
        const pinError = document.getElementById('pinError');

        function checkAuth() {
            const isAuthenticated = sessionStorage.getItem('thwebworks_authenticated');
            if (isAuthenticated === 'true') {
                showMainContent();
            }
        }

        function showMainContent() {
            authOverlay.classList.add('hidden');
            mainContent.classList.remove('hidden');
        }

        pinForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const enteredPin = pinInput.value;
            
            if (enteredPin === CORRECT_PIN) {
                sessionStorage.setItem('thwebworks_authenticated', 'true');
                showMainContent();
                pinError.classList.add('hidden');
            } else {
                pinError.classList.remove('hidden');
                pinInput.value = '';
                pinInput.focus();
            }
        });

        pinInput.focus();
        checkAuth();

        // Prevent right-click and dev tools
        document.addEventListener('contextmenu', function(e) { e.preventDefault(); });
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I') || (e.ctrlKey && e.key === 'u')) {
            e.preventDefault();
            }
        });

        // --- Icon Mapping ---
        const icons = {
            'briefcase': 'üíº',
            'target': 'üéØ',
            'layout': 'üìÑ',
            'settings': '‚öôÔ∏è',
            'palette': 'üé®',
            'dollar': 'üí∞',
            'user': 'üë§',
            'check': '‚úÖ',
            'Restaurant': 'üçΩÔ∏è',
            'Retail Store': 'üõçÔ∏è',
            'Service Business': 'üîß',
            'Consulting': 'üí°',
            'Health & Wellness': 'üè•',
            'Trades': 'üî®',
            'Nonprofit': 'ü§ù',
            'Education': 'üìö',
            'Real Estate': 'üè†',
            'Technology': 'üíª',
            'Other': 'üìã'
        };

        function getIcon(key) {
            return icons[key] || 'üìã';
        }

        // --- Helper Functions for Form Interactions ---
        function selectRadioOption(name, value) {
            formData[name] = value;
            
            // Update visual state
            const options = document.querySelectorAll(`input[name="${name}"]`);
            options.forEach(option => {
                const optionDiv = option.closest('.input-option');
                if (option.value === value) {
                    option.checked = true;
                    optionDiv.classList.add('selected');
                } else {
                    option.checked = false;
                    optionDiv.classList.remove('selected');
                }
            });
            
            // Trigger preview update
            handleImmediateVisualChanges({ name, value });
            updatePreview();
        }

        function toggleCheckboxOption(name, value) {
            if (!formData[name]) formData[name] = [];
            
            const optionDiv = document.querySelector(`input[name="${name}"][value="${value}"]`).closest('.input-option');
            const checkbox = optionDiv.querySelector('input[type="checkbox"]');
            
            if (checkbox.checked) {
                // Uncheck
                checkbox.checked = false;
                optionDiv.classList.remove('selected');
                formData[name] = formData[name].filter(v => v !== value);
            } else {
                // Check
                checkbox.checked = true;
                optionDiv.classList.add('selected');
                formData[name].push(value);
            }
            
            // Trigger preview update
            handleImmediateVisualChanges({ name, value });
            updatePreview();
        }

        // --- Creative Brief Wizard with Dynamic Preview ---
    const wizardSteps = [
            // 0. Welcome
        {
            title: '',
            icon: '',
            fields: [
                { type: 'branding', logo: 'Images/THLogo_trans.webp', mission: 'Premium web development for businesses that want to stand out.', subheader: 'Let\'s build your dream website together.' },
                    { type: 'intro', label: '', description: 'This guided process will help us understand your vision and requirements. Watch the preview update as you make selections!' },
                    { type: 'button', label: 'Start Building', action: 'next', classes: 'bg-[#3abbfa] hover:bg-[#2a9ee0] text-white px-6 py-2 rounded font-semibold mt-8 w-full md:w-auto' }
                ]
            },
            // 1. Business Type
            {
                title: 'What type of business are you?',
            icon: 'briefcase',
            fields: [
                    { type: 'radio', name: 'businessType', label: 'Select your business type', options: ['Restaurant', 'Retail Store', 'Service Business', 'Consulting', 'Health & Wellness', 'Trades', 'Nonprofit', 'Education', 'Real Estate', 'Technology', 'Other'], required: true }
                ]
            },
            // 2. Main Goals
            {
                title: 'What are your main website goals?',
            icon: 'target',
            fields: [
                    { type: 'checkbox-group', name: 'goals', label: 'Select all that apply', options: ['Lead Generation', 'Online Booking', 'Selling Products', 'Portfolio Display', 'Event Promotion', 'Content Marketing', 'SEO Visibility', 'Brand Trust', 'Client Login', 'Other'], vertical: true, required: true }
                ]
            },
            // 3. Pages Needed
            {
                title: 'What pages do you need?',
            icon: 'layout',
            fields: [
                { type: 'checkbox-group', name: 'pagesCore', label: 'Core Pages', options: ['Home', 'About', 'Services', 'Contact'], vertical: true },
                    { type: 'checkbox-group', name: 'pagesTrust', label: 'Trust Building', options: ['Testimonials', 'FAQ', 'Case Studies', 'Team'], vertical: true },
                    { type: 'checkbox-group', name: 'pagesEngage', label: 'Engagement', options: ['Blog', 'Resources', 'Events', 'Newsletter'], vertical: true },
                    { type: 'checkbox-group', name: 'pagesCommerce', label: 'Commerce', options: ['Online Store', 'Booking System', 'Pricing', 'Cart'], vertical: true }
                ]
            },
            // 4. Features
            {
                title: 'What features do you need?',
            icon: 'settings',
            fields: [
                    { type: 'checkbox-group', name: 'features', label: 'Select needed features', options: ['Contact Forms', 'Online Scheduler', 'Payment Processing', 'Newsletter Signup', 'Google Maps', 'Client Dashboard', 'Live Chat', 'Social Media Integration', 'Analytics', 'Mobile App'], vertical: true }
            ]
        },
            // 5. Design Style
        {
                title: 'What design style appeals to you?',
            icon: 'palette',
            fields: [
                    { type: 'radio', name: 'designStyle', label: 'Choose your preferred style', options: ['Modern & Clean', 'Bold & Creative', 'Professional & Corporate', 'Warm & Friendly', 'Minimalist', 'Luxury & Premium'], required: true }
                ]
            },
            // 6. Color Preferences
            {
                title: 'Color Preferences',
                icon: 'palette',
            fields: [
                    { type: 'color', name: 'primaryColor', label: 'Primary Color', placeholder: '#3abbfa or blue', required: true },
                    { type: 'color', name: 'secondaryColor', label: 'Secondary Color', placeholder: '#f3a515 or gold', required: true },
                    { type: 'text', name: 'exampleSites', label: 'Example websites you like', placeholder: 'Paste URLs separated by commas' }
                ]
            },
            // 7. Contact & Budget
            {
                title: 'Contact Details & Budget',
            icon: 'mail',
            fields: [
                { type: 'email', name: 'email', label: 'Business Email', required: true },
                { type: 'tel', name: 'phone', label: 'Phone Number', required: true },
                { type: 'radio', name: 'budget', label: 'Budget Range', options: ['<$500', '$500‚Äì$1000', '$1000‚Äì$2000', '$2000+'], required: true },
                { type: 'dropdown', name: 'timeline', label: 'Timeline', options: ['ASAP', '1 week', '2‚Äì4 weeks', '1‚Äì2 months'] },
                    { type: 'textarea', name: 'additionalNotes', label: 'Any additional notes or requirements?' },
                { type: 'summary' },
                { type: 'button', label: 'Download Summary', action: 'download', classes: 'bg-[#71a3c1] hover:bg-[#3abbfa] text-white px-6 py-2 rounded font-semibold mt-4 w-full md:w-auto' },
                    { type: 'button', label: 'Submit Request', action: 'submit', classes: 'bg-[#3abbfa] hover:bg-[#2a9ee0] text-white px-6 py-2 rounded font-semibold mt-4 w-full md:w-auto' }
                ]
            }
        ];



    // --- State ---
    let currentStep = 0;
    let formData = {};
        
        // Initialize form data with default values
        function initializeFormData() {
            formData = {
                businessType: '',
                goals: [],
                pagesCore: [],
                pagesTrust: [],
                pagesEngage: [],
                pagesCommerce: [],
                features: [],
                designStyle: '',
                primaryColor: '#3abbfa',
                secondaryColor: '#f39c12',
                email: '',
                phone: '',
                budget: '',
                timeline: '',
                additionalNotes: '',
                exampleSites: ''
            };
        }

        // --- ENHANCED PREVIEW TEMPLATES WITH UNIQUE LAYOUTS ---
        const previewTemplates = {
            'Restaurant': {
                name: 'Bella Vista Restaurant',
                tagline: 'Authentic Italian Cuisine & Fine Dining',
                features: ['Online ordering', 'Reservations', 'Menu showcase', 'Location & hours', 'Chef specials', 'Private dining'],
                color: '#e74c3c',
                heroImage: 'üçΩÔ∏è',
                icons: ['üçï', 'üç∑', 'üë®‚Äçüç≥', 'üìÖ'],
                specialties: ['Italian Cuisine', 'Fine Dining', 'Catering Services'],
                layout: 'restaurant',
                sections: ['hero', 'menu-preview', 'reservations', 'testimonials', 'location', 'gallery']
            },
            'Retail Store': {
                name: 'Urban Style Boutique',
                tagline: 'Trendsetting Fashion & Lifestyle',
                features: ['Product catalog', 'Online shopping', 'Store locator', 'Customer reviews', 'Loyalty program', 'Flash sales'],
                color: '#3498db',
                heroImage: 'üõçÔ∏è',
                icons: ['üì¶', 'üí≥', '‚≠ê', 'üè™'],
                specialties: ['Fashion', 'Electronics', 'Home & Garden'],
                layout: 'retail',
                sections: ['hero', 'featured-products', 'categories', 'reviews', 'newsletter', 'store-locator']
            },
            'Service Business': {
                name: 'ProFix Solutions',
                tagline: 'Professional Services You Can Trust',
                features: ['Service showcase', 'Booking system', 'Testimonials', 'Contact forms', 'Service areas', 'Emergency calls'],
                color: '#2ecc71',
                heroImage: 'üîß',
                icons: ['‚öôÔ∏è', 'üìû', 'üí¨', 'üìç'],
                specialties: ['24/7 Support', 'Guaranteed Work', 'Free Estimates'],
                layout: 'service',
                sections: ['hero', 'services-grid', 'why-choose-us', 'testimonials', 'service-areas', 'emergency-contact']
            },
            'Consulting': {
                name: 'Strategic Growth Partners',
                tagline: 'Expert Solutions for Business Success',
                features: ['Case studies', 'Expert team', 'Services overview', 'Client testimonials', 'Strategy sessions', 'ROI tracking'],
                color: '#9b59b6',
                heroImage: 'üìä',
                icons: ['üìà', 'üë•', 'üíº', 'üéØ'],
                specialties: ['Business Strategy', 'Digital Transformation', 'Growth Consulting'],
                layout: 'consulting',
                sections: ['hero', 'expertise-areas', 'case-studies', 'team', 'process', 'results']
            },
            'Health & Wellness': {
                name: 'Wellness Center',
                tagline: 'Your Health & Wellness Journey Starts Here',
                features: ['Appointment booking', 'Service descriptions', 'Health tips', 'Patient portal', 'Insurance accepted', 'Telemedicine'],
                color: '#1abc9c',
                heroImage: 'üíö',
                icons: ['üè•', 'üíä', 'üßò', 'üì±'],
                specialties: ['Preventive Care', 'Holistic Wellness', 'Emergency Care'],
                layout: 'health',
                sections: ['hero', 'services-list', 'providers', 'appointments', 'wellness-blog', 'patient-portal']
            },
            'Trades': {
                name: 'MasterCraft Trades',
                tagline: 'Quality Workmanship & Reliable Service',
                features: ['Service areas', 'Project gallery', 'Free quotes', 'Emergency contact', 'Licensed & insured', 'Warranty'],
                color: '#f39c12',
                heroImage: 'üî®',
                icons: ['üè†', 'üõ†Ô∏è', 'üìã', 'üö®'],
                specialties: ['Residential', 'Commercial', 'Emergency Repairs'],
                layout: 'trades',
                sections: ['hero', 'services-showcase', 'project-gallery', 'certifications', 'service-areas', 'emergency-contact']
            },
            'Nonprofit': {
                name: 'Community Impact Foundation',
                tagline: 'Making a Difference Together',
                features: ['Donation portal', 'Volunteer signup', 'Impact stories', 'Events calendar', 'Newsletter', 'Transparency reports'],
                color: '#e67e22',
                heroImage: 'ü§ù',
                icons: ['üíù', 'üôã', 'üìñ', 'üìÖ'],
                specialties: ['Community Service', 'Education', 'Environmental'],
                layout: 'nonprofit',
                sections: ['hero', 'mission-impact', 'donate-volunteer', 'programs', 'events', 'transparency']
            },
            'Education': {
                name: 'Innovation Academy',
                tagline: 'Empowering Minds, Building Futures',
                features: ['Course catalog', 'Student portal', 'Faculty directory', 'Events calendar', 'Alumni network', 'Online learning'],
                color: '#34495e',
                heroImage: 'üéì',
                icons: ['üìö', 'üë®‚Äçüè´', 'üéØ', 'üåê'],
                specialties: ['Higher Education', 'Professional Development', 'Online Courses'],
                layout: 'education',
                sections: ['hero', 'programs-overview', 'faculty', 'student-life', 'admissions', 'alumni-network']
            },
            'Real Estate': {
                name: 'Premier Real Estate Group',
                tagline: 'Find Your Dream Home',
                features: ['Property listings', 'Virtual tours', 'Mortgage calculator', 'Agent profiles', 'Market insights', 'Contact forms'],
                color: '#8e44ad',
                heroImage: 'üè†',
                icons: ['üîë', 'üìä', 'üë•', 'üìû'],
                specialties: ['Residential', 'Commercial', 'Investment Properties'],
                layout: 'real-estate',
                sections: ['hero', 'featured-properties', 'search-tools', 'agents', 'market-insights', 'mortgage-calculator']
            },
            'Technology': {
                name: 'TechFlow Solutions',
                tagline: 'Innovation at Your Fingertips',
                features: ['Product demos', 'API documentation', 'Support portal', 'Case studies', 'Developer resources', 'Pricing plans'],
                color: '#2c3e50',
                heroImage: 'üíª',
                icons: ['üöÄ', 'üîß', 'üì±', '‚òÅÔ∏è'],
                specialties: ['SaaS Solutions', 'Mobile Apps', 'Cloud Services'],
                layout: 'technology',
                sections: ['hero', 'products-showcase', 'features', 'pricing', 'case-studies', 'developer-hub']
            }
        };

    // --- Render Step ---
    function renderStep(idx) {
        const step = wizardSteps[idx];
        const form = document.getElementById('wizardForm');
        form.innerHTML = '';
            
        // Step header
            if (step.title) {
                form.innerHTML += `
                    <div class="form-step active">
                        <h2 class="step-title flex items-center">
                            ${step.icon ? `<span class="mr-4">${getIcon(step.icon)}</span>` : ''}
                            ${step.title}
                        </h2>
                        ${step.description ? `<p class="step-description">${step.description}</p>` : ''}
                    </div>
                `;
            }
            
        // Fields
        step.fields.forEach(field => {
            if (field.type === 'branding') {
                form.innerHTML += `
                        <div class="form-group text-center">
                            <img src="${field.logo}" alt="T&H WebWorks Logo" class="h-20 mx-auto mb-4">
                            <div class="text-text-muted text-lg mb-2">${field.mission}</div>
                            <div class="text-text-muted text-sm mb-4">${field.subheader}</div>
                            <div class="flex gap-3 justify-center">
                                <span class="w-6 h-6 rounded-full shadow-glow" style="background:var(--primary)"></span>
                                <span class="w-6 h-6 rounded-full shadow-glow" style="background:var(--secondary)"></span>
                                <span class="w-6 h-6 rounded-full shadow-glow" style="background:var(--accent)"></span>
                        </div>
                        </div>
                    `;
            } else if (field.type === 'intro') {
                    form.innerHTML += `
                        <div class="form-group">
                            <p class="step-description">${field.description}</p>
                        </div>
                    `;
            } else if (field.type === 'text' || field.type === 'email' || field.type === 'tel') {
                form.innerHTML += `
                        <div class="form-group">
                            <label class="form-label">${field.label}${field.required ? ' <span class="text-error">*</span>' : ''}</label>
                            <input type="${field.type}" name="${field.name}" placeholder="${field.placeholder || ''}" 
                                   class="input-option w-full p-4 text-white" 
                                   ${field.required ? 'required' : ''} 
                                   value="${formData[field.name] || ''}">
                        </div>
                    `;
            } else if (field.type === 'color') {
                form.innerHTML += `
                        <div class="form-group">
                            <label class="form-label">${field.label}</label>
                            <div class="flex items-center gap-4">
                                <input type="color" name="${field.name}" 
                                       class="w-16 h-16 p-0 border-none bg-transparent rounded-lg cursor-pointer" 
                                       value="${formData[field.name] || '#3abbfa'}">
                                <input type="text" name="${field.name}" placeholder="${field.placeholder || ''}" 
                                       class="input-option flex-1 p-4 text-white" 
                                       value="${formData[field.name] || ''}">
                            </div>
                        </div>
                    `;
            } else if (field.type === 'radio') {
                form.innerHTML += `
                        <div class="form-group">
                            <label class="form-label">${field.label}${field.required ? ' <span class="text-error">*</span>' : ''}</label>
                            <div class="input-group ${field.vertical ? 'grid-cols-1' : 'grid-cols-2 md:grid-cols-3'}">
                            ${field.options.map(opt => `
                                    <div class="input-option ${formData[field.name] === opt ? 'selected' : ''}" onclick="selectRadioOption('${field.name}', '${opt}')">
                                        <input type="radio" name="${field.name}" value="${opt}" 
                                               ${formData[field.name] === opt ? 'checked' : ''}>
                                        <label class="option-label">
                                            <div class="option-icon">${getIcon(opt)}</div>
                                    <span>${opt}</span>
                                </label>
                                    </div>
                            `).join('')}
                        </div>
                        </div>
                    `;
            } else if (field.type === 'checkbox-group') {
                form.innerHTML += `
                        <div class="form-group">
                            <label class="form-label">${field.label}${field.required ? ' <span class="text-error">*</span>' : ''}</label>
                            <div class="input-group ${field.vertical ? 'grid-cols-1' : 'grid-cols-2 md:grid-cols-3'}">
                            ${field.options.map(opt => `
                                    <div class="input-option ${formData[field.name] && formData[field.name].includes(opt) ? 'selected' : ''}" onclick="toggleCheckboxOption('${field.name}', '${opt}')">
                                        <input type="checkbox" name="${field.name}" value="${opt}" 
                                               ${formData[field.name] && formData[field.name].includes(opt) ? 'checked' : ''}>
                                        <label class="option-label">
                                            <div class="option-icon">${getIcon(opt)}</div>
                                    <span>${opt}</span>
                                </label>
                                    </div>
                            `).join('')}
                        </div>
                        </div>
                    `;
                } else if (field.type === 'dropdown') {
                form.innerHTML += `
                        <div class="form-group">
                            <label class="form-label">${field.label}</label>
                            <select name="${field.name}" class="input-option w-full p-4 text-white">
                                <option value="">Select...</option>
                                ${field.options.map(opt => `<option value="${opt}" ${formData[field.name] === opt ? 'selected' : ''}>${opt}</option>`).join('')}
                            </select>
                        </div>
                    `;
            } else if (field.type === 'textarea') {
                form.innerHTML += `
                        <div class="form-group">
                            <label class="form-label">${field.label}</label>
                            <textarea name="${field.name}" rows="4" 
                                      class="input-option w-full p-4 text-white resize-none">${formData[field.name] || ''}</textarea>
                        </div>
                    `;
            } else if (field.type === 'button') {
                    form.innerHTML += `
                        <div class="form-group text-center">
                            <button type="button" class="btn btn-primary text-lg px-8 py-4" data-action="${field.action}">
                                ${field.label}
                            </button>
                        </div>
                    `;
            } else if (field.type === 'summary') {
                    form.innerHTML += `
                        <div class="form-group">
                            <div class="input-option p-6">
                                ${renderSummary()}
                            </div>
                        </div>
                    `;
                }
            });
            
        // Navigation
        if (idx > 0 && idx < wizardSteps.length - 1) {
                form.innerHTML += `
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary" data-action="back">‚Üê Back</button>
                        <button type="button" class="btn btn-primary" data-action="next">Continue ‚Üí</button>
                    </div>
                `;
            }
            
        // Progress bar
        document.getElementById('progressStep').textContent = idx + 1;
        document.getElementById('progressTotal').textContent = wizardSteps.length;
            document.getElementById('progressLabel').textContent = step.title || 'Welcome';
        document.getElementById('progressBar').style.width = `${((idx+1)/wizardSteps.length)*100}%`;
        }

        // --- Enhanced Update Preview with Animations ---
        function updatePreview() {
            const preview = document.getElementById('sitePreview');
            const details = document.getElementById('previewDetails');
            const progressBar = document.getElementById('progressBar');
            
            // Add loading animation
            preview.style.opacity = '0.7';
            preview.style.transform = 'scale(0.98)';
            
            setTimeout(() => {
                if (!formData.businessType) {
                    preview.querySelector('.preview-content').innerHTML = `
                        <div class="preview-placeholder float-animation">
                            <div style="text-align: center;">
                                <div style="font-size: 48px; margin-bottom: 16px;">üé®</div>
                                <div>Start building your site to see a live preview</div>
                                <div style="font-size: 12px; margin-top: 8px; opacity: 0.7;">Select your business type to begin</div>
                            </div>
                        </div>
                    `;
                    details.innerHTML = '<p>Select options to see your site configuration</p>';
                } else {
                    const template = previewTemplates[formData.businessType] || previewTemplates['Service Business'];
                    const primaryColor = formData.primaryColor || template.color;
                    const designStyle = formData.designStyle || 'Modern & Clean';
                    
                    // Generate preview HTML
                    const previewHTML = generateSitePreview(template, primaryColor, designStyle);
                    preview.querySelector('.preview-content').innerHTML = previewHTML;
                    
                    // Add interactive elements to preview
                    addPreviewInteractions();
                    
                    // Add additional interactive elements
                    addInteractiveElements();
                    
                    // Animate counters if analytics section exists
                    setTimeout(() => {
                        if (document.querySelector('.analytics-section')) {
                            animateCounters();
                        }
                    }, 500);
                    
                    // Update details with animations
                    let detailsHTML = `<p><strong>Business Type:</strong> ${formData.businessType}</p>`;
                    if (formData.goals && formData.goals.length > 0) {
                        detailsHTML += `<p><strong>Goals:</strong> ${formData.goals.join(', ')}</p>`;
                    }
                    if (formData.pagesCore && formData.pagesCore.length > 0) {
                        detailsHTML += `<p><strong>Pages:</strong> ${formData.pagesCore.join(', ')}</p>`;
                    }
                    if (formData.features && formData.features.length > 0) {
                        detailsHTML += `<p><strong>Features:</strong> ${formData.features.join(', ')}</p>`;
                    }
                    detailsHTML += `<p><strong>Style:</strong> ${designStyle}</p>`;
                    
                    // Add estimated cost based on selections
                    const estimatedCost = calculateEstimatedCost();
                    if (estimatedCost) {
                        detailsHTML += `<p><strong>Estimated Cost:</strong> <span style="color: #3abbfa; font-weight: bold;">${estimatedCost}</span></p>`;
                    }
                    
                    details.innerHTML = detailsHTML;
                }
                
                // Restore preview
                preview.style.opacity = '1';
                preview.style.transform = 'scale(1)';
                
                // Add animated progress bar
                progressBar.classList.add('progress-animated');
                setTimeout(() => progressBar.classList.remove('progress-animated'), 2000);
                
            }, 300);
        }
        
        // --- Add Interactive Elements to Preview ---
        function addPreviewInteractions() {
            const preview = document.getElementById('sitePreview');
            
            // Add hover effects to buttons
            const buttons = preview.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px) scale(1.05)';
                    this.style.boxShadow = '0 8px 25px rgba(0,0,0,0.3)';
                });
                
                button.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                    this.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
                });
            });
            
            // Add click effects to navigation
            const navItems = preview.querySelectorAll('nav span');
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove active class from all items
                    navItems.forEach(nav => nav.style.color = '');
                    navItems.forEach(nav => nav.style.fontWeight = '400');
                    
                    // Add active class to clicked item
                    this.style.color = '#3abbfa';
                    this.style.fontWeight = '600';
                    
                    // Add pulse animation
                    this.classList.add('pulse-animation');
                    setTimeout(() => this.classList.remove('pulse-animation'), 1000);
                });
            });
            
            // Add floating animation to hero emoji
            const heroEmoji = preview.querySelector('div[style*="font-size: 64px"]');
            if (heroEmoji) {
                heroEmoji.classList.add('float-animation');
            }
        }
        
        // --- Calculate Estimated Cost ---
        function calculateEstimatedCost() {
            let baseCost = 0;
            
            // Base cost by business type
            const businessCosts = {
                'Restaurant': 1500,
                'Retail Store': 2000,
                'Service Business': 1200,
                'Consulting': 1800,
                'Health & Wellness': 1600,
                'Trades': 1400,
                'Nonprofit': 1000,
                'Education': 2200,
                'Real Estate': 2500,
                'Technology': 3000
            };
            
            baseCost = businessCosts[formData.businessType] || 1500;
            
            // Add cost for features
            if (formData.features) {
                const featureCosts = {
                    'Online Scheduler': 300,
                    'Payment Processing': 400,
                    'Client Dashboard': 500,
                    'Live Chat': 200,
                    'Social Media Integration': 150,
                    'Analytics': 100,
                    'Mobile App': 800
                };
                
                formData.features.forEach(feature => {
                    baseCost += featureCosts[feature] || 0;
                });
            }
            
            // Add cost for pages
            if (formData.pagesCore) {
                baseCost += formData.pagesCore.length * 100;
            }
            if (formData.pagesTrust) {
                baseCost += formData.pagesTrust.length * 150;
            }
            if (formData.pagesEngage) {
                baseCost += formData.pagesEngage.length * 200;
            }
            if (formData.pagesCommerce) {
                baseCost += formData.pagesCommerce.length * 300;
            }
            
            // Format cost
            if (baseCost < 1000) {
                return `$${baseCost}`;
            } else if (baseCost < 5000) {
                return `$${(baseCost/1000).toFixed(1)}k`;
            } else {
                return `$${(baseCost/1000).toFixed(0)}k`;
            }
        }

        // --- ULTRA-DYNAMIC SITE PREVIEW GENERATOR ---
        function generateSitePreview(template, primaryColor, designStyle) {
            // Get all form data for dynamic content
            const businessName = formData.businessName || template.name;
            const businessType = formData.businessType || 'Service Business';
            const goals = formData.goals || [];
            const pagesCore = formData.pagesCore || [];
            const pagesTrust = formData.pagesTrust || [];
            const pagesEngage = formData.pagesEngage || [];
            const pagesCommerce = formData.pagesCommerce || [];
            const features = formData.features || [];
            const colorScheme = formData.colorScheme || 'Blue';
            
            // Dynamic content based on selections
            const hasBooking = goals.includes('Online Booking');
            const hasStore = goals.includes('Selling Products');
            const hasBlog = pagesEngage.includes('Blog');
            const hasTestimonials = pagesTrust.includes('Testimonials');
            const hasContact = features.includes('Contact Forms');
            const hasAnalytics = features.includes('Analytics');
            const hasLiveChat = features.includes('Live Chat');
            const hasPayment = features.includes('Payment Processing');
            const hasScheduler = features.includes('Online Scheduler');
            const hasDashboard = features.includes('Client Dashboard');
            const hasSocial = features.includes('Social Media Integration');
            const hasMobile = features.includes('Mobile App');
            
            // Dynamic navigation based on selected pages
            const navItems = ['Home'];
            if (pagesCore.includes('About')) navItems.push('About');
            if (pagesCore.includes('Services')) navItems.push('Services');
            if (pagesCore.includes('Contact')) navItems.push('Contact');
            if (hasBlog) navItems.push('Blog');
            if (hasTestimonials) navItems.push('Reviews');
            if (pagesTrust.includes('FAQ')) navItems.push('FAQ');
            if (pagesEngage.includes('Newsletter')) navItems.push('Newsletter');
            if (hasStore) navItems.push('Shop');
            if (hasBooking) navItems.push('Book Now');
            
            // Style variations based on design style
            const isModern = designStyle.includes('Modern');
            const isBold = designStyle.includes('Bold');
            const isProfessional = designStyle.includes('Professional');
            const isWarm = designStyle.includes('Warm');
            const isMinimalist = designStyle.includes('Minimalist');
            const isLuxury = designStyle.includes('Luxury');
            
            // Dynamic color schemes
            const colorPalettes = {
                'Blue': { primary: '#3498db', secondary: '#2980b9', accent: '#e3f2fd' },
                'Green': { primary: '#2ecc71', secondary: '#27ae60', accent: '#e8f5e8' },
                'Purple': { primary: '#9b59b6', secondary: '#8e44ad', accent: '#f3e5f5' },
                'Orange': { primary: '#e67e22', secondary: '#d35400', accent: '#fff3e0' },
                'Red': { primary: '#e74c3c', secondary: '#c0392b', accent: '#ffebee' },
                'Teal': { primary: '#1abc9c', secondary: '#16a085', accent: '#e0f2f1' },
                'Pink': { primary: '#e91e63', secondary: '#c2185b', accent: '#fce4ec' },
                'Yellow': { primary: '#f39c12', secondary: '#e67e22', accent: '#fff8e1' }
            };
            
            const colors = colorPalettes[colorScheme] || colorPalettes['Blue'];
            
            // Dynamic header style based on design
            const headerStyle = isModern ? `linear-gradient(135deg, ${colors.primary}, ${adjustColor(colors.primary, -30)})` :
                               isLuxury ? `linear-gradient(45deg, ${colors.primary}, ${adjustColor(colors.primary, -20)}, ${adjustColor(colors.primary, -40)})` :
                               isMinimalist ? colors.primary : colors.primary;
            
            // Generate layout-specific preview with dynamic content
            const layout = template.layout || 'default';
            
            switch(layout) {
                case 'restaurant':
                    return generateRestaurantLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'retail':
                    return generateRetailLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'service':
                    return generateServiceLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'consulting':
                    return generateConsultingLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'health':
                    return generateHealthLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'trades':
                    return generateTradesLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'nonprofit':
                    return generateNonprofitLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'education':
                    return generateEducationLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'real-estate':
                    return generateRealEstateLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                case 'technology':
                    return generateTechnologyLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
                default:
                    return generateDefaultLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage);
            }
        }

        // --- Layout-Specific Preview Generators ---
        
        function generateRestaurantLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            const isModern = designStyle.includes('Modern');
            const isLuxury = designStyle.includes('Luxury');
            const isMinimalist = designStyle.includes('Minimalist');
            const isBold = designStyle.includes('Bold');
            
            // Dynamic header style
            const headerStyle = isModern ? `linear-gradient(135deg, ${colors.primary}, ${adjustColor(colors.primary, -30)})` :
                               isLuxury ? `linear-gradient(45deg, ${colors.primary}, ${adjustColor(colors.primary, -20)}, ${adjustColor(colors.primary, -40)})` :
                               isMinimalist ? colors.primary : colors.primary;
            
            // Dynamic content based on selections
            const showMenu = hasStore || (pagesCore && pagesCore.includes('Services'));
            const showReservations = hasBooking || hasScheduler;
            const showTestimonials = hasTestimonials;
            const showBlog = hasBlog;
            const showContact = hasContact;
            const showAnalytics = hasAnalytics;
            const showLiveChat = hasLiveChat;
            const showPayment = hasPayment;
            const showDashboard = hasDashboard;
            const showSocial = hasSocial;
            const showMobile = hasMobile;
            
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <!-- Dynamic Restaurant Header -->
                    <header style="background: ${headerStyle}; color: white; padding: ${isMinimalist ? '30px 20px' : '20px'}; text-align: center; position: relative; overflow: hidden;">
                        ${isLuxury ? `<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');"></div>` : ''}
                        <div style="position: relative; z-index: 1;">
                            <div style="font-size: ${isBold ? '28px' : '24px'}; font-weight: ${isBold ? '800' : 'bold'}; margin-bottom: 5px; text-shadow: ${isBold ? '2px 2px 4px rgba(0,0,0,0.3)' : 'none'};">${businessName}</div>
                            <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                            <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px; flex-wrap: wrap;">
                                ${navItems.map((item, index) => `
                                    <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; ${index === 0 ? 'background: rgba(255,255,255,0.2);' : ''} transition: all 0.3s;">${item}</span>
                                `).join('')}
                            </nav>
                        </div>
                    </header>
                    
                    <!-- Dynamic Hero Section -->
                    <section style="background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200"><rect width="400" height="200" fill="${colors.primary}"/><text x="200" y="100" text-anchor="middle" fill="white" font-size="48">${template.heroImage}</text></svg>'); background-size: cover; color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px; animation: float 3s ease-in-out infinite;">${template.heroImage}</div>
                        <h1 style="font-size: ${isBold ? '32px' : '28px'}; margin-bottom: 10px; font-weight: ${isBold ? '800' : 'bold'}; text-shadow: ${isBold ? '2px 2px 4px rgba(0,0,0,0.3)' : 'none'};">Experience Fine Dining</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Authentic Italian cuisine in an elegant atmosphere</p>
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            ${showReservations ? `<button style="background: white; color: ${colors.primary}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">Make Reservation</button>` : ''}
                            ${showMenu ? `<button style="background: transparent; color: white; border: 2px solid white; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">View Menu</button>` : ''}
                            ${showContact ? `<button style="background: transparent; color: white; border: 2px solid white; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Contact Us</button>` : ''}
                        </div>
                    </section>
                    
                    ${showMenu ? `
                    <!-- Dynamic Menu Preview -->
                    <section style="padding: 40px 20px; background: ${colors.accent};">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${colors.primary}; font-size: 24px;">Our Menu</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="font-size: 24px; margin-bottom: 10px;">üçï</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">Margherita Pizza</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">Fresh mozzarella, basil, tomato sauce</p>
                                <div style="color: ${colors.primary}; font-weight: bold;">${showPayment ? '$18' : 'View Details'}</div>
                            </div>
                            <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="font-size: 24px; margin-bottom: 10px;">üçù</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">Spaghetti Carbonara</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">Eggs, cheese, pancetta, black pepper</p>
                                <div style="color: ${colors.primary}; font-weight: bold;">${showPayment ? '$22' : 'View Details'}</div>
                            </div>
                            <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="font-size: 24px; margin-bottom: 10px;">üç∑</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">House Wine</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">Premium Italian red wine</p>
                                <div style="color: ${colors.primary}; font-weight: bold;">${showPayment ? '$12/glass' : 'View Details'}</div>
                            </div>
                        </div>
                    </section>
                    ` : ''}
                    
                    ${showReservations ? `
                    <!-- Dynamic Reservations Section -->
                    <section style="padding: 40px 20px; background: ${colors.primary}; color: white; text-align: center;">
                        <h2 style="margin-bottom: 20px; font-size: 24px;">Book Your Table</h2>
                        <p style="margin-bottom: 30px; opacity: 0.9;">Reserve your spot for an unforgettable dining experience</p>
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            <button style="background: white; color: ${colors.primary}; border: none; padding: 15px 40px; border-radius: 25px; font-weight: bold; cursor: pointer;">Book Now</button>
                            ${showScheduler ? `<button style="background: transparent; color: white; border: 2px solid white; padding: 15px 40px; border-radius: 25px; font-weight: bold; cursor: pointer;">Schedule Online</button>` : ''}
                        </div>
                    </section>
                    ` : ''}
                    
                    ${showTestimonials ? `
                    <!-- Dynamic Testimonials Section -->
                    <section style="padding: 40px 20px; background: #f9f9f9;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${colors.primary}; font-size: 24px;">What Our Customers Say</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="color: ${colors.primary}; font-size: 24px; margin-bottom: 10px;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                <p style="color: #666; font-style: italic; margin-bottom: 15px;">"Amazing food and atmosphere! The service was impeccable."</p>
                                <div style="font-weight: bold;">- Sarah M.</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="color: ${colors.primary}; font-size: 24px; margin-bottom: 10px;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                <p style="color: #666; font-style: italic; margin-bottom: 15px;">"Best Italian restaurant in town. Highly recommend!"</p>
                                <div style="font-weight: bold;">- John D.</div>
                            </div>
                        </div>
                    </section>
                    ` : ''}
                    
                    ${showBlog ? `
                    <!-- Dynamic Blog Section -->
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${colors.primary}; font-size: 24px;">Latest News</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="height: 150px; background: ${colors.accent}; display: flex; align-items: center; justify-content: center; font-size: 48px;">üçï</div>
                                <div style="padding: 20px;">
                                    <h3 style="margin-bottom: 10px; font-weight: bold;">New Seasonal Menu</h3>
                                    <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Discover our fresh spring ingredients and new dishes.</p>
                                    <div style="color: ${colors.primary}; font-weight: bold; cursor: pointer;">Read More ‚Üí</div>
                                </div>
                            </div>
                        </div>
                    </section>
                    ` : ''}
                    
                    ${showAnalytics ? `
                    <!-- Dynamic Analytics Section -->
                    <section style="padding: 40px 20px; background: ${colors.primary}; color: white;">
                        <h2 style="text-align: center; margin-bottom: 30px; font-size: 24px;">Our Success</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 30px;">
                            <div style="text-align: center;">
                                <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">500+</div>
                                <div style="font-size: 14px; opacity: 0.9;">Happy Customers</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">1000+</div>
                                <div style="font-size: 14px; opacity: 0.9;">Meals Served</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">5‚òÖ</div>
                                <div style="font-size: 14px; opacity: 0.9;">Average Rating</div>
                            </div>
                        </div>
                    </section>
                    ` : ''}
                    
                    ${showLiveChat ? `
                    <!-- Live Chat Widget -->
                    <div style="position: fixed; bottom: 20px; right: 20px; background: ${colors.primary}; color: white; padding: 15px; border-radius: 50px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 1000;">
                        <div style="font-size: 24px;">üí¨</div>
                    </div>
                    ` : ''}
                    
                    <!-- Dynamic Footer -->
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="max-width: 1200px; margin: 0 auto;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; margin-bottom: 30px; text-align: left;">
                                <div>
                                    <h4 style="margin-bottom: 15px; color: ${colors.primary};">${businessName}</h4>
                                    <p style="margin: 0; opacity: 0.8; line-height: 1.6;">${template.tagline}</p>
                                </div>
                                <div>
                                    <h4 style="margin-bottom: 15px; color: ${colors.primary};">Quick Links</h4>
                                    <div style="display: flex; flex-direction: column; gap: 8px;">
                                        ${navItems.slice(0, 4).map(item => `<a href="#" style="color: white; text-decoration: none; opacity: 0.8;">${item}</a>`).join('')}
                                    </div>
                                </div>
                                ${showContact ? `
                                <div>
                                    <h4 style="margin-bottom: 15px; color: ${colors.primary};">Contact</h4>
                                    <p style="margin: 0 0 8px 0; opacity: 0.8;">üìß info@${businessName.toLowerCase().replace(/\s+/g, '')}.com</p>
                                    <p style="margin: 0 0 8px 0; opacity: 0.8;">üìû (555) 123-4567</p>
                                    <p style="margin: 0; opacity: 0.8;">üìç 123 Main Street, City, State</p>
                                </div>
                                ` : ''}
                                ${showSocial ? `
                                <div>
                                    <h4 style="margin-bottom: 15px; color: ${colors.primary};">Follow Us</h4>
                                    <div style="display: flex; gap: 10px;">
                                        <span style="cursor: pointer; opacity: 0.8;">üìò</span>
                                        <span style="cursor: pointer; opacity: 0.8;">üì∑</span>
                                        <span style="cursor: pointer; opacity: 0.8;">üê¶</span>
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                            <div style="border-top: 1px solid #555; padding-top: 20px; opacity: 0.8;">
                                <p style="margin: 0;">¬© 2025 ${businessName}. All rights reserved.</p>
                            </div>
                        </div>
                    </footer>
                </div>
            `;
        }
        
        function generateRetailLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            const isModern = designStyle.includes('Modern');
            const isLuxury = designStyle.includes('Luxury');
            const isMinimalist = designStyle.includes('Minimalist');
            const isBold = designStyle.includes('Bold');
            
            // Dynamic header style
            const headerStyle = isModern ? `linear-gradient(135deg, ${colors.primary}, ${adjustColor(colors.primary, -30)})` :
                               isLuxury ? `linear-gradient(45deg, ${colors.primary}, ${adjustColor(colors.primary, -20)}, ${adjustColor(colors.primary, -40)})` :
                               isMinimalist ? colors.primary : colors.primary;
            
            // Dynamic content based on selections
            const showProducts = hasStore;
            const showNewsletter = pagesEngage && pagesEngage.includes('Newsletter');
            const showTestimonials = hasTestimonials;
            const showBlog = hasBlog;
            const showContact = hasContact;
            const showAnalytics = hasAnalytics;
            const showLiveChat = hasLiveChat;
            const showPayment = hasPayment;
            const showDashboard = hasDashboard;
            const showSocial = hasSocial;
            const showMobile = hasMobile;
            
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <!-- Dynamic Retail Header -->
                    <header style="background: ${headerStyle}; color: white; padding: ${isMinimalist ? '30px 20px' : '20px'}; text-align: center; position: relative; overflow: hidden;">
                        ${isLuxury ? `<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');"></div>` : ''}
                        <div style="position: relative; z-index: 1;">
                            <div style="font-size: ${isBold ? '28px' : '24px'}; font-weight: ${isBold ? '800' : 'bold'}; margin-bottom: 5px; text-shadow: ${isBold ? '2px 2px 4px rgba(0,0,0,0.3)' : 'none'};">${businessName}</div>
                            <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                            <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px; flex-wrap: wrap;">
                                ${navItems.map((item, index) => `
                                    <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; ${index === 0 ? 'background: rgba(255,255,255,0.2);' : ''} transition: all 0.3s;">${item}</span>
                                `).join('')}
                            </nav>
                        </div>
                    </header>
                    
                    <!-- Dynamic Hero Section -->
                    <section style="background: linear-gradient(45deg, ${colors.primary}, ${adjustColor(colors.primary, -20)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px; animation: float 3s ease-in-out infinite;">${template.heroImage}</div>
                        <h1 style="font-size: ${isBold ? '32px' : '28px'}; margin-bottom: 10px; font-weight: ${isBold ? '800' : 'bold'}; text-shadow: ${isBold ? '2px 2px 4px rgba(0,0,0,0.3)' : 'none'};">Trendsetting Fashion</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Discover the latest styles and exclusive collections</p>
                        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                            ${showProducts ? `<button style="background: white; color: ${colors.primary}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">Shop Now</button>` : ''}
                            ${showContact ? `<button style="background: transparent; color: white; border: 2px solid white; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Contact Us</button>` : ''}
                            ${showNewsletter ? `<button style="background: transparent; color: white; border: 2px solid white; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Newsletter</button>` : ''}
                        </div>
                    </section>
                    
                    ${showProducts ? `
                    <!-- Dynamic Featured Products -->
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${colors.primary}; font-size: 24px;">Featured Products</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="height: 150px; background: ${colors.accent}; display: flex; align-items: center; justify-content: center; font-size: 48px;">üëï</div>
                                <div style="padding: 15px;">
                                    <h3 style="margin-bottom: 5px; font-weight: bold;">Premium T-Shirt</h3>
                                    <p style="color: #666; font-size: 14px; margin-bottom: 10px;">100% cotton, comfortable fit</p>
                                    <div style="color: ${colors.primary}; font-weight: bold;">${showPayment ? '$29.99' : 'View Details'}</div>
                                </div>
                            </div>
                            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="height: 150px; background: ${colors.accent}; display: flex; align-items: center; justify-content: center; font-size: 48px;">üëñ</div>
                                <div style="padding: 15px;">
                                    <h3 style="margin-bottom: 5px; font-weight: bold;">Designer Jeans</h3>
                                    <p style="color: #666; font-size: 14px; margin-bottom: 10px;">Premium denim, perfect fit</p>
                                    <div style="color: ${colors.primary}; font-weight: bold;">${showPayment ? '$89.99' : 'View Details'}</div>
                                </div>
                            </div>
                            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="height: 150px; background: ${colors.accent}; display: flex; align-items: center; justify-content: center; font-size: 48px;">üëü</div>
                                <div style="padding: 15px;">
                                    <h3 style="margin-bottom: 5px; font-weight: bold;">Sneakers</h3>
                                    <p style="color: #666; font-size: 14px; margin-bottom: 10px;">Comfortable and stylish</p>
                                    <div style="color: ${colors.primary}; font-weight: bold;">${showPayment ? '$79.99' : 'View Details'}</div>
                                </div>
                            </div>
                        </div>
                    </section>
                    ` : ''}
                    
                    ${showNewsletter ? `
                    <!-- Dynamic Newsletter -->
                    <section style="background: ${colors.accent}; padding: 40px 20px; text-align: center;">
                        <h2 style="margin-bottom: 20px; color: ${colors.primary}; font-size: 24px;">Stay Updated</h2>
                        <p style="margin-bottom: 20px; color: #666;">Get the latest fashion trends and exclusive offers</p>
                        <div style="display: flex; justify-content: center; gap: 10px; max-width: 400px; margin: 0 auto;">
                            <input type="email" placeholder="Enter your email" style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 5px;">
                            <button style="background: ${colors.primary}; color: white; border: none; padding: 12px 20px; border-radius: 5px; cursor: pointer;">Subscribe</button>
                        </div>
                    </section>
                    ` : ''}
                    
                    <!-- Footer -->
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">456 Fashion Ave, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 987-6543</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateDefaultLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            const isModern = designStyle.includes('Modern');
            const isBold = designStyle.includes('Bold');
            const isProfessional = designStyle.includes('Professional');
            const isWarm = designStyle.includes('Warm');
            const isMinimalist = designStyle.includes('Minimalist');
            const isLuxury = designStyle.includes('Luxury');
            
            const headerStyle = isModern ? `linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)})` :
                                   isLuxury ? `linear-gradient(45deg, ${primaryColor}, ${adjustColor(primaryColor, -20)}, ${adjustColor(primaryColor, -40)})` :
                                   isMinimalist ? primaryColor : primaryColor;
            
            const cardStyle = isMinimalist ? 'border: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1)' :
                             isLuxury ? 'border: 1px solid #ddd; box-shadow: 0 8px 25px rgba(0,0,0,0.15)' :
                             'border: 1px solid #eee; box-shadow: 0 4px 12px rgba(0,0,0,0.1)';
            
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <!-- Dynamic Header -->
                    <header style="background: ${headerStyle}; color: white; padding: ${isMinimalist ? '30px 20px' : '25px 20px'}; text-align: center; position: relative; overflow: hidden;">
                        ${isLuxury ? `<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');"></div>` : ''}
                        <div style="position: relative; z-index: 1;">
                            <div style="font-size: 48px; margin-bottom: 10px;">${template.heroImage}</div>
                            <h1 style="margin: 0; font-size: ${isBold ? '28px' : '24px'}; font-weight: ${isBold ? '800' : '600'}; text-shadow: ${isBold ? '2px 2px 4px rgba(0,0,0,0.3)' : 'none'};">${template.name}</h1>
                            <p style="margin: 8px 0 0 0; opacity: 0.9; font-size: 14px; font-style: ${isWarm ? 'italic' : 'normal'};">${template.tagline}</p>
                        </div>
                    </header>
                    
                    <!-- Dynamic Navigation -->
                    <nav style="background: ${isProfessional ? '#f8f9fa' : isMinimalist ? '#fff' : '#fff'}; padding: 15px 20px; border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 10;">
                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 14px; max-width: 1200px; margin: 0 auto;">
                            <div style="display: flex; gap: 20px;">
                                ${navItems.map(item => `<span style="font-weight: ${item === 'Home' ? '600' : '400'}; cursor: pointer; transition: color 0.3s;">${item}</span>`).join('')}
                            </div>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                ${hasBooking ? `<span style="background: ${primaryColor}; color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">Book Now</span>` : ''}
                                ${hasStore ? `<span style="background: ${adjustColor(primaryColor, 20)}; color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600; cursor: pointer;">Shop</span>` : ''}
                            </div>
                        </div>
                    </nav>
                    
                    <!-- Hero Section with Dynamic Content -->
                    <section style="padding: 60px 20px; text-align: center; background: ${isModern ? 'linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)' : isWarm ? '#fff5f5' : '#fff'}; position: relative;">
                        ${isWarm ? `<div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: ${primaryColor};"></div>` : ''}
                        <div style="max-width: 800px; margin: 0 auto;">
                            <div style="font-size: 64px; margin-bottom: 20px;">${template.heroImage}</div>
                            <h2 style="font-size: ${isBold ? '36px' : '32px'}; margin-bottom: 20px; color: #333; font-weight: ${isBold ? '800' : '600'};">Welcome to ${template.name}</h2>
                            <p style="color: #666; margin-bottom: 30px; font-size: 18px; line-height: 1.8;">${template.tagline}</p>
                            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                                <button style="background: ${primaryColor}; color: white; border: none; padding: 15px 30px; border-radius: ${isMinimalist ? '4px' : '25px'}; font-weight: 600; cursor: pointer; font-size: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: transform 0.3s;">Get Started</button>
                                ${hasContact ? `<button style="background: transparent; color: ${primaryColor}; border: 2px solid ${primaryColor}; padding: 15px 30px; border-radius: ${isMinimalist ? '4px' : '25px'}; font-weight: 600; cursor: pointer; font-size: 16px;">Contact Us</button>` : ''}
                            </div>
                        </div>
                    </section>
                    
                    <!-- Dynamic Features Section -->
                    ${template.features.length > 0 ? `
                        <section style="padding: 60px 20px; background: #fff;">
                            <div style="max-width: 1200px; margin: 0 auto;">
                                <h3 style="text-align: center; margin-bottom: 40px; color: #333; font-size: 28px; font-weight: 600;">What We Offer</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px;">
                                    ${template.features.slice(0, 6).map((feature, index) => `
                                        <div style="text-align: center; padding: 30px 20px; ${cardStyle}; border-radius: ${isMinimalist ? '4px' : '12px'}; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer;">
                                            <div style="font-size: 48px; margin-bottom: 15px;">${template.icons[index] || '‚ú®'}</div>
                                            <h4 style="margin: 0 0 12px 0; font-size: 18px; color: #333; font-weight: 600;">${feature}</h4>
                                            <p style="margin: 0; color: #666; font-size: 14px;">Professional ${feature.toLowerCase()} services</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </section>
                    ` : ''}
                    
                    <!-- Dynamic Specialties Section -->
                    ${template.specialties ? `
                        <section style="padding: 40px 20px; background: ${isModern ? '#f8f9fa' : '#fff'};">
                            <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
                                <h3 style="margin-bottom: 30px; color: #333; font-size: 24px;">Our Specialties</h3>
                                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                                    ${template.specialties.map(specialty => `
                                        <span style="background: ${primaryColor}; color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: 500;">${specialty}</span>
                                    `).join('')}
                                </div>
                            </div>
                        </section>
                    ` : ''}
                    
                    <!-- Dynamic Stats Section (if analytics selected) -->
                    ${hasAnalytics ? `
                        <section style="padding: 40px 20px; background: ${primaryColor}; color: white;">
                            <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
                                <h3 style="margin-bottom: 30px; font-size: 24px;">Our Impact</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 30px;">
                                    <div>
                                        <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">500+</div>
                                        <div style="font-size: 14px; opacity: 0.9;">Happy Clients</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">1000+</div>
                                        <div style="font-size: 14px; opacity: 0.9;">Projects Completed</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">5‚òÖ</div>
                                        <div style="font-size: 14px; opacity: 0.9;">Average Rating</div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    ` : ''}
                    
                    <!-- Enhanced Footer -->
                    <footer style="background: #333; color: white; padding: 40px 20px; text-align: center;">
                        <div style="max-width: 1200px; margin: 0 auto;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; margin-bottom: 30px; text-align: left;">
                                <div>
                                    <h4 style="margin-bottom: 15px; color: ${primaryColor};">${template.name}</h4>
                                    <p style="margin: 0; opacity: 0.8; line-height: 1.6;">${template.tagline}</p>
                                </div>
                                <div>
                                    <h4 style="margin-bottom: 15px; color: ${primaryColor};">Quick Links</h4>
                                    <div style="display: flex; flex-direction: column; gap: 8px;">
                                        ${navItems.slice(0, 4).map(item => `<a href="#" style="color: white; text-decoration: none; opacity: 0.8;">${item}</a>`).join('')}
                                    </div>
                                </div>
                                <div>
                                    <h4 style="margin-bottom: 15px; color: ${primaryColor};">Contact</h4>
                                    <p style="margin: 0 0 8px 0; opacity: 0.8;">üìß info@${template.name.toLowerCase().replace(/\s+/g, '')}.com</p>
                                    <p style="margin: 0 0 8px 0; opacity: 0.8;">üìû (555) 123-4567</p>
                                    <p style="margin: 0; opacity: 0.8;">üìç 123 Business St, City, State</p>
                                </div>
                            </div>
                            <div style="border-top: 1px solid #555; padding-top: 20px; opacity: 0.8;">
                                <p style="margin: 0;">¬© 2025 ${template.name}. All rights reserved.</p>
                            </div>
                        </div>
                    </footer>
                </div>
            `;
        }

        // --- Additional Layout Functions ---
        
        function generateServiceLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <!-- Service Header -->
                    <header style="background: ${primaryColor}; color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Services</span>
                            <span style="cursor: pointer; padding: 5px 10px;">About</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Contact</span>
                        </nav>
                    </header>
                    
                    <!-- Hero Section -->
                    <section style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Professional Services</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Quality workmanship you can trust</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Get Quote</button>
                    </section>
                    
                    <!-- Services Grid -->
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Services</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üîß</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Repair Services</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Fast and reliable repair solutions</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">From $50</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">‚ö°</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Emergency Service</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">24/7 emergency response</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Call Now</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üìã</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Maintenance</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Preventive maintenance plans</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Monthly Plans</div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Why Choose Us -->
                    <section style="background: #f9f9f9; padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Why Choose Us</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div style="text-align: center;">
                                <div style="font-size: 32px; margin-bottom: 10px;">‚≠ê</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">5-Star Rated</h3>
                                <p style="color: #666; font-size: 14px;">Consistently excellent reviews</p>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 32px; margin-bottom: 10px;">üïí</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">Fast Response</h3>
                                <p style="color: #666; font-size: 14px;">Same-day service available</p>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 32px; margin-bottom: 10px;">üíØ</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">Guaranteed</h3>
                                <p style="color: #666; font-size: 14px;">100% satisfaction guarantee</p>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Footer -->
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">789 Service St, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 456-7890</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateConsultingLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <!-- Consulting Header -->
                    <header style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -40)}); color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Services</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Case Studies</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Team</span>
                        </nav>
                    </header>
                    
                    <!-- Hero Section -->
                    <section style="background: linear-gradient(45deg, ${primaryColor}, ${adjustColor(primaryColor, -20)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Strategic Business Solutions</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Expert consulting to drive your business growth</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Schedule Consultation</button>
                    </section>
                    
                    <!-- Expertise Areas -->
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Expertise</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
                            <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="font-size: 36px; margin-bottom: 15px;">üìà</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Business Strategy</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Comprehensive strategic planning and execution</p>
                                <ul style="color: #666; font-size: 14px; padding-left: 20px;">
                                    <li>Market analysis</li>
                                    <li>Competitive positioning</li>
                                    <li>Growth strategies</li>
                                </ul>
                            </div>
                            <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="font-size: 36px; margin-bottom: 15px;">üíº</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Digital Transformation</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Modernize your business with technology</p>
                                <ul style="color: #666; font-size: 14px; padding-left: 20px;">
                                    <li>Process optimization</li>
                                    <li>Technology integration</li>
                                    <li>Change management</li>
                                </ul>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Process -->
                    <section style="background: #f9f9f9; padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Process</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div style="text-align: center;">
                                <div style="width: 60px; height: 60px; background: ${primaryColor}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-weight: bold;">1</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">Discovery</h3>
                                <p style="color: #666; font-size: 14px;">Understanding your needs</p>
                            </div>
                            <div style="text-align: center;">
                                <div style="width: 60px; height: 60px; background: ${primaryColor}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-weight: bold;">2</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">Strategy</h3>
                                <p style="color: #666; font-size: 14px;">Developing solutions</p>
                            </div>
                            <div style="text-align: center;">
                                <div style="width: 60px; height: 60px; background: ${primaryColor}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-weight: bold;">3</div>
                                <h3 style="margin-bottom: 5px; font-weight: bold;">Implementation</h3>
                                <p style="color: #666; font-size: 14px;">Executing the plan</p>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Footer -->
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">321 Business Ave, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 789-0123</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateHealthLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <header style="background: ${primaryColor}; color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Services</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Providers</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Appointments</span>
                        </nav>
                    </header>
                    
                    <section style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Your Health Journey</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Comprehensive wellness care for you and your family</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Book Appointment</button>
                    </section>
                    
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Services</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üè•</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Primary Care</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Comprehensive health checkups</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Schedule Today</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üßò</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Wellness Programs</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Holistic health solutions</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üì±</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Telemedicine</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Virtual consultations available</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Start Visit</div>
                            </div>
                        </div>
                    </section>
                    
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">456 Health Blvd, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 234-5678</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateTradesLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <header style="background: ${primaryColor}; color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Services</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Gallery</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Contact</span>
                        </nav>
                    </header>
                    
                    <section style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Quality Workmanship</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Licensed, insured, and guaranteed work</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Get Free Quote</button>
                    </section>
                    
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Services</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üè†</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Residential</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Home repairs and renovations</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üè¢</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Commercial</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Business and office work</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üö®</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Emergency</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">24/7 emergency service</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Call Now</div>
                            </div>
                        </div>
                    </section>
                    
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">789 Trade St, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 345-6789</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateNonprofitLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <header style="background: ${primaryColor}; color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Programs</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Donate</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Volunteer</span>
                        </nav>
                    </header>
                    
                    <section style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Making a Difference</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Join us in creating positive change</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Donate Now</button>
                    </section>
                    
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Programs</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üíù</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Community Service</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Supporting local communities</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üìñ</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Education</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Empowering through knowledge</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üå±</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Environmental</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Protecting our planet</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                        </div>
                    </section>
                    
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">321 Impact Way, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 456-7890</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateEducationLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <header style="background: ${primaryColor}; color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Programs</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Faculty</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Admissions</span>
                        </nav>
                    </header>
                    
                    <section style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Empowering Minds</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Building futures through education</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Apply Now</button>
                    </section>
                    
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Programs</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üìö</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Higher Education</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Bachelor's and Master's degrees</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üéØ</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Professional Development</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Career advancement courses</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üåê</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Online Courses</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Flexible learning options</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                        </div>
                    </section>
                    
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">654 Education Dr, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 567-8901</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateRealEstateLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <header style="background: ${primaryColor}; color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Properties</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Agents</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Contact</span>
                        </nav>
                    </header>
                    
                    <section style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Find Your Dream Home</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Expert real estate services</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Search Properties</button>
                    </section>
                    
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Featured Properties</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="height: 150px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; font-size: 48px;">üè†</div>
                                <div style="padding: 15px;">
                                    <h3 style="margin-bottom: 5px; font-weight: bold;">Modern Family Home</h3>
                                    <p style="color: #666; font-size: 14px; margin-bottom: 10px;">3 bed, 2 bath, 1,500 sq ft</p>
                                    <div style="color: ${primaryColor}; font-weight: bold;">$450,000</div>
                                </div>
                            </div>
                            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="height: 150px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; font-size: 48px;">üè¢</div>
                                <div style="padding: 15px;">
                                    <h3 style="margin-bottom: 5px; font-weight: bold;">Downtown Condo</h3>
                                    <p style="color: #666; font-size: 14px; margin-bottom: 10px;">2 bed, 1 bath, 900 sq ft</p>
                                    <div style="color: ${primaryColor}; font-weight: bold;">$280,000</div>
                                </div>
                            </div>
                            <div style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                <div style="height: 150px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; font-size: 48px;">üè°</div>
                                <div style="padding: 15px;">
                                    <h3 style="margin-bottom: 5px; font-weight: bold;">Luxury Estate</h3>
                                    <p style="color: #666; font-size: 14px; margin-bottom: 10px;">5 bed, 4 bath, 3,200 sq ft</p>
                                    <div style="color: ${primaryColor}; font-weight: bold;">$1,200,000</div>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">987 Real Estate Blvd, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 678-9012</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }
        
        function generateTechnologyLayout(template, colors, designStyle, businessName, navItems, hasBooking, hasStore, hasBlog, hasTestimonials, hasContact, hasAnalytics, hasLiveChat, hasPayment, hasScheduler, hasDashboard, hasSocial, hasMobile, pagesCore, pagesEngage) {
            return `
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #333; line-height: 1.6;">
                    <header style="background: ${primaryColor}; color: white; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 5px;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.9;">${template.tagline}</div>
                        <nav style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; font-size: 12px;">
                            <span style="cursor: pointer; padding: 5px 10px; border-radius: 15px; background: rgba(255,255,255,0.2);">Home</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Products</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Solutions</span>
                            <span style="cursor: pointer; padding: 5px 10px;">Support</span>
                        </nav>
                    </header>
                    
                    <section style="background: linear-gradient(135deg, ${primaryColor}, ${adjustColor(primaryColor, -30)}); color: white; text-align: center; padding: 60px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">${template.heroImage}</div>
                        <h1 style="font-size: 28px; margin-bottom: 10px; font-weight: bold;">Innovation at Your Fingertips</h1>
                        <p style="font-size: 16px; margin-bottom: 30px; opacity: 0.9;">Cutting-edge technology solutions</p>
                        <button style="background: white; color: ${primaryColor}; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer;">Get Started</button>
                    </section>
                    
                    <section style="padding: 40px 20px;">
                        <h2 style="text-align: center; margin-bottom: 30px; color: ${primaryColor}; font-size: 24px;">Our Solutions</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üöÄ</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">SaaS Solutions</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Cloud-based software platforms</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">üì±</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Mobile Apps</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">iOS and Android development</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 36px; margin-bottom: 15px;">‚òÅÔ∏è</div>
                                <h3 style="margin-bottom: 10px; font-weight: bold;">Cloud Services</h3>
                                <p style="color: #666; font-size: 14px; margin-bottom: 15px;">Scalable cloud infrastructure</p>
                                <div style="color: ${primaryColor}; font-weight: bold;">Learn More</div>
                            </div>
                        </div>
                    </section>
                    
                    <footer style="background: #333; color: white; padding: 30px 20px; text-align: center;">
                        <div style="margin-bottom: 20px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">${template.name}</div>
                            <div style="font-size: 14px; opacity: 0.8;">159 Tech Park, City, State</div>
                            <div style="font-size: 14px; opacity: 0.8;">(555) 789-0123</div>
                        </div>
                        <div style="font-size: 12px; opacity: 0.6;">¬© 2024 ${template.name}. All rights reserved.</div>
                    </footer>
                </div>
            `;
        }

        // --- Utility Functions ---
        function adjustColor(color, amount) {
            const hex = color.replace('#', '');
            const num = parseInt(hex, 16);
            const r = Math.min(255, Math.max(0, (num >> 16) + amount));
            const g = Math.min(255, Math.max(0, ((num >> 8) & 0x00FF) + amount));
            const b = Math.min(255, Math.max(0, (num & 0x0000FF) + amount));
            return '#' + (r << 16 | g << 8 | b).toString(16).padStart(6, '0');
        }

    function renderSummary() {
        const params = new URLSearchParams(window.location.search);
        if (params.get('admin') === 'true') {
            return `<pre class='text-xs whitespace-pre-wrap break-all'>${JSON.stringify(formData, null, 2)}</pre>`;
        }
        return '<div class="text-gray-400 text-sm">Thank you! Your creative brief is ready for review and submission.</div>';
    }

        // --- Navigation ---
    function goToStep(idx) {
        currentStep = idx;
        renderStep(currentStep);
            updatePreview();
    }

    function nextStep() {
        if (!validateStep(currentStep)) return;
        goToStep(currentStep + 1);
    }

    function prevStep() {
        goToStep(currentStep - 1);
    }

    function validateStep(idx) {
        const step = wizardSteps[idx];
        let valid = true;
        step.fields.forEach(field => {
            if (field.required) {
                if (field.type === 'checkbox-group') {
                    if (!formData[field.name] || !formData[field.name].length) valid = false;
                } else if (!formData[field.name]) {
                    valid = false;
                }
            }
        });
        return valid;
    }

        // --- ULTRA-DYNAMIC Event Handling with Real-Time Visual Changes ---
    document.getElementById('wizardForm').addEventListener('input', function(e) {
        const t = e.target;
            
            // Add visual feedback
            if (t.type === 'checkbox' || t.type === 'radio') {
                // Add pulse animation to the label
                const label = t.closest('label');
                if (label) {
                    label.style.transform = 'scale(1.05)';
                    label.style.transition = 'transform 0.2s ease';
                    setTimeout(() => {
                        label.style.transform = 'scale(1)';
                    }, 200);
                }
            }
            
            // Update form data
        if (t.type === 'checkbox') {
            if (!formData[t.name]) formData[t.name] = [];
            if (t.checked) {
                if (!formData[t.name].includes(t.value)) formData[t.name].push(t.value);
            } else {
                formData[t.name] = formData[t.name].filter(v => v !== t.value);
            }
        } else if (t.type === 'radio') {
            formData[t.name] = t.value;
        } else {
            formData[t.name] = t.value;
        }
            
            // Add success indicator
            if (t.type === 'color') {
                const colorPreview = t.parentElement.querySelector('input[type="color"]');
                if (colorPreview) {
                    colorPreview.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        colorPreview.style.transform = 'scale(1)';
                    }, 300);
                }
            }
            
            // IMMEDIATE visual feedback for specific options
            handleImmediateVisualChanges(t);
            
            // Update preview with delay for better UX
            clearTimeout(window.previewTimeout);
            window.previewTimeout = setTimeout(() => {
                updatePreview();
            }, 200);
        });
        
        // --- Handle Immediate Visual Changes for Each Option ---
        function handleImmediateVisualChanges(target) {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Business Type Changes
            if (target.name === 'businessType' && target.value) {
                const template = previewTemplates[target.value];
                if (template) {
                    // Immediately change the hero emoji and color
                    const heroSection = previewContent.querySelector('section[style*="padding: 60px"]');
                    if (heroSection) {
                        const emojiDiv = heroSection.querySelector('div[style*="font-size: 64px"]');
                        if (emojiDiv) {
                            emojiDiv.innerHTML = template.heroImage;
                            emojiDiv.style.animation = 'none';
                            setTimeout(() => {
                                emojiDiv.style.animation = 'float 3s ease-in-out infinite';
                            }, 10);
                        }
                    }
                    
                    // Change header color immediately
                    const header = previewContent.querySelector('header');
                    if (header) {
                        header.style.background = template.color;
                        header.style.transition = 'background 0.5s ease';
                    }
                }
            }
            
            // Goals Changes - Show/Hide specific elements
            if (target.name === 'goals') {
                const hasBooking = formData.goals && formData.goals.includes('Online Booking');
                const hasStore = formData.goals && formData.goals.includes('Selling Products');
                const hasPortfolio = formData.goals && formData.goals.includes('Portfolio Display');
                
                // Show/hide booking button
                const nav = previewContent.querySelector('nav');
                if (nav) {
                    let bookingBtn = nav.querySelector('.booking-btn');
                    if (hasBooking && !bookingBtn) {
                        const newBtn = document.createElement('span');
                        newBtn.className = 'booking-btn';
                        newBtn.style.cssText = 'background: #3abbfa; color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600; cursor: pointer; margin-left: 10px; animation: slideIn 0.3s ease;';
                        newBtn.textContent = 'Book Now';
                        nav.querySelector('div:last-child').appendChild(newBtn);
                    } else if (!hasBooking && bookingBtn) {
                        bookingBtn.style.animation = 'slideOut 0.3s ease';
                        setTimeout(() => bookingBtn.remove(), 300);
                    }
                }
                
                // Show/hide shop button
                if (nav) {
                    let shopBtn = nav.querySelector('.shop-btn');
                    if (hasStore && !shopBtn) {
                        const newBtn = document.createElement('span');
                        newBtn.className = 'shop-btn';
                        newBtn.style.cssText = 'background: #f39c12; color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600; cursor: pointer; margin-left: 10px; animation: slideIn 0.3s ease;';
                        newBtn.textContent = 'Shop';
                        nav.querySelector('div:last-child').appendChild(newBtn);
                    } else if (!hasStore && shopBtn) {
                        shopBtn.style.animation = 'slideOut 0.3s ease';
                        setTimeout(() => shopBtn.remove(), 300);
                    }
                }
                
                // Add portfolio gallery if selected
                if (hasPortfolio) {
                    addPortfolioSection();
                }
            }
            
            // Pages Changes - Update navigation dynamically
            if (target.name && target.name.startsWith('pages')) {
                updateNavigationDynamically();
            }
            
            // Features Changes - Add/remove feature sections
            if (target.name === 'features') {
                const hasAnalytics = formData.features && formData.features.includes('Analytics');
                const hasLiveChat = formData.features && formData.features.includes('Live Chat');
                const hasNewsletter = formData.features && formData.features.includes('Newsletter Signup');
                
                // Add/remove analytics section
                if (hasAnalytics) {
                    addAnalyticsSection();
                } else {
                    removeAnalyticsSection();
                }
                
                // Add/remove live chat widget
                if (hasLiveChat) {
                    addLiveChatWidget();
                } else {
                    removeLiveChatWidget();
                }
                
                // Add/remove newsletter signup
                if (hasNewsletter) {
                    addNewsletterSection();
                } else {
                    removeNewsletterSection();
                }
            }
            
            // Design Style Changes - Immediate visual updates
            if (target.name === 'designStyle') {
                applyDesignStyleImmediately(target.value);
            }
            
            // Color Changes - Immediate color updates
            if (target.name === 'primaryColor') {
                updateColorsImmediately(target.value);
            }
        }
        
        // --- Dynamic Navigation Updates ---
        function updateNavigationDynamically() {
            const preview = document.getElementById('sitePreview');
            const nav = preview.querySelector('nav');
            if (!nav) return;
            
            const navContainer = nav.querySelector('div:first-child');
            const currentItems = navContainer.querySelectorAll('span');
            
            // Remove all current items except Home
            currentItems.forEach(item => {
                if (item.textContent !== 'Home') {
                    item.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => item.remove(), 300);
                }
            });
            
            // Add new items based on selections
            setTimeout(() => {
                if (formData.pagesCore && formData.pagesCore.includes('About')) {
                    addNavItem('About', navContainer);
                }
                if (formData.pagesCore && formData.pagesCore.includes('Services')) {
                    addNavItem('Services', navContainer);
                }
                if (formData.pagesCore && formData.pagesCore.includes('Contact')) {
                    addNavItem('Contact', navContainer);
                }
                if (formData.pagesEngage && formData.pagesEngage.includes('Blog')) {
                    addNavItem('Blog', navContainer);
                }
                if (formData.pagesTrust && formData.pagesTrust.includes('Testimonials')) {
                    addNavItem('Reviews', navContainer);
                }
            }, 350);
        }
        
        function addNavItem(text, container) {
            const item = document.createElement('span');
            item.textContent = text;
            item.style.cssText = 'font-weight: 400; cursor: pointer; transition: color 0.3s; animation: slideIn 0.3s ease;';
            item.style.marginRight = '20px';
            container.appendChild(item);
        }
        
        // --- Add Dynamic Sections ---
        function addPortfolioSection() {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Remove existing portfolio section
            const existing = previewContent.querySelector('.portfolio-section');
            if (existing) existing.remove();
            
            const portfolioSection = document.createElement('section');
            portfolioSection.className = 'portfolio-section';
            portfolioSection.style.cssText = 'padding: 40px 20px; background: #f8f9fa; animation: slideIn 0.5s ease;';
            
            portfolioSection.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto;">
                    <h3 style="text-align: center; margin-bottom: 30px; color: #333; font-size: 24px;">Our Portfolio</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <div style="height: 150px; background: linear-gradient(45deg, #3abbfa, #2a9ee0); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px;">üì∏</div>
                            <div style="padding: 20px;">
                                <h4 style="margin: 0 0 10px 0; color: #333;">Project 1</h4>
                                <p style="margin: 0; color: #666; font-size: 14px;">Amazing project description</p>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <div style="height: 150px; background: linear-gradient(45deg, #f39c12, #e67e22); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px;">üé®</div>
                            <div style="padding: 20px;">
                                <h4 style="margin: 0 0 10px 0; color: #333;">Project 2</h4>
                                <p style="margin: 0; color: #666; font-size: 14px;">Creative design showcase</p>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <div style="height: 150px; background: linear-gradient(45deg, #2ecc71, #27ae60); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px;">üíª</div>
                            <div style="padding: 20px;">
                                <h4 style="margin: 0 0 10px 0; color: #333;">Project 3</h4>
                                <p style="margin: 0; color: #666; font-size: 14px;">Technical implementation</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Insert before footer
            const footer = previewContent.querySelector('footer');
            if (footer) {
                footer.parentNode.insertBefore(portfolioSection, footer);
            }
        }
        
        function addAnalyticsSection() {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Remove existing analytics section
            const existing = previewContent.querySelector('.analytics-section');
            if (existing) existing.remove();
            
            const analyticsSection = document.createElement('section');
            analyticsSection.className = 'analytics-section';
            analyticsSection.style.cssText = 'padding: 40px 20px; background: #3abbfa; color: white; animation: slideIn 0.5s ease;';
            
            analyticsSection.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
                    <h3 style="margin-bottom: 30px; font-size: 24px;">üìä Analytics Dashboard</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 30px;">
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                            <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">1.2K</div>
                            <div style="font-size: 14px; opacity: 0.9;">Monthly Visitors</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                            <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">85%</div>
                            <div style="font-size: 14px; opacity: 0.9;">Conversion Rate</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                            <div style="font-size: 36px; font-weight: bold; margin-bottom: 5px;">$12K</div>
                            <div style="font-size: 14px; opacity: 0.9;">Monthly Revenue</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Insert before footer
            const footer = previewContent.querySelector('footer');
            if (footer) {
                footer.parentNode.insertBefore(analyticsSection, footer);
            }
        }
        
        function removeAnalyticsSection() {
            const analyticsSection = document.querySelector('.analytics-section');
            if (analyticsSection) {
                analyticsSection.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => analyticsSection.remove(), 300);
            }
        }
        
        function addLiveChatWidget() {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Remove existing chat widget
            const existing = previewContent.querySelector('.chat-widget');
            if (existing) existing.remove();
            
            const chatWidget = document.createElement('div');
            chatWidget.className = 'chat-widget';
            chatWidget.style.cssText = 'position: fixed; bottom: 20px; right: 20px; background: #3abbfa; color: white; padding: 15px; border-radius: 50px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2); animation: slideIn 0.3s ease; z-index: 1000;';
            chatWidget.innerHTML = 'üí¨ Chat with us!';
            
            previewContent.appendChild(chatWidget);
        }
        
        function removeLiveChatWidget() {
            const chatWidget = document.querySelector('.chat-widget');
            if (chatWidget) {
                chatWidget.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => chatWidget.remove(), 300);
            }
        }
        
        function addNewsletterSection() {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Remove existing newsletter section
            const existing = previewContent.querySelector('.newsletter-section');
            if (existing) existing.remove();
            
            const newsletterSection = document.createElement('section');
            newsletterSection.className = 'newsletter-section';
            newsletterSection.style.cssText = 'padding: 40px 20px; background: #f8f9fa; animation: slideIn 0.5s ease;';
            
            newsletterSection.innerHTML = `
                <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                    <h3 style="margin-bottom: 20px; color: #333; font-size: 24px;">üìß Stay Updated</h3>
                    <p style="margin-bottom: 30px; color: #666;">Get the latest updates and exclusive offers!</p>
                    <div style="display: flex; gap: 10px; justify-content: center; max-width: 400px; margin: 0 auto;">
                        <input type="email" placeholder="Enter your email" style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                        <button style="background: #3abbfa; color: white; border: none; padding: 12px 20px; border-radius: 4px; cursor: pointer; font-weight: 600;">Subscribe</button>
                    </div>
                </div>
            `;
            
            // Insert before footer
            const footer = previewContent.querySelector('footer');
            if (footer) {
                footer.parentNode.insertBefore(newsletterSection, footer);
            }
        }
        
        function removeNewsletterSection() {
            const newsletterSection = document.querySelector('.newsletter-section');
            if (newsletterSection) {
                newsletterSection.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => newsletterSection.remove(), 300);
            }
        }
        
        // --- Apply Design Style Immediately ---
        function applyDesignStyleImmediately(style) {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            const isModern = style.includes('Modern');
            const isBold = style.includes('Bold');
            const isProfessional = style.includes('Professional');
            const isWarm = style.includes('Warm');
            const isMinimalist = style.includes('Minimalist');
            const isLuxury = style.includes('Luxury');
            
            // Update header style
            const header = previewContent.querySelector('header');
            if (header) {
                if (isModern) {
                    header.style.background = 'linear-gradient(135deg, #3abbfa, #2a9ee0)';
                } else if (isLuxury) {
                    header.style.background = 'linear-gradient(45deg, #3abbfa, #2a9ee0, #1a8ed0)';
                } else if (isMinimalist) {
                    header.style.background = '#3abbfa';
                } else {
                    header.style.background = '#3abbfa';
                }
                header.style.transition = 'background 0.5s ease';
            }
            
            // Update typography
            const headings = previewContent.querySelectorAll('h1, h2, h3');
            headings.forEach(heading => {
                if (isBold) {
                    heading.style.fontWeight = '800';
                    heading.style.textShadow = '2px 2px 4px rgba(0,0,0,0.3)';
                } else {
                    heading.style.fontWeight = '600';
                    heading.style.textShadow = 'none';
                }
            });
            
            // Update card styles
            const cards = previewContent.querySelectorAll('div[style*="border-radius"]');
            cards.forEach(card => {
                if (isMinimalist) {
                    card.style.border = 'none';
                    card.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                } else if (isLuxury) {
                    card.style.border = '1px solid #ddd';
                    card.style.boxShadow = '0 8px 25px rgba(0,0,0,0.15)';
                }
            });
        }
        
        // --- Update Colors Immediately ---
        function updateColorsImmediately(color) {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Update header
            const header = previewContent.querySelector('header');
            if (header) {
                header.style.background = color;
                header.style.transition = 'background 0.5s ease';
            }
            
            // Update buttons
            const buttons = previewContent.querySelectorAll('button');
            buttons.forEach(button => {
                if (button.style.background !== 'transparent') {
                    button.style.background = color;
                    button.style.transition = 'background 0.3s ease';
                }
            });
            
            // Update feature icons
            const featureIcons = previewContent.querySelectorAll('div[style*="font-size: 48px"]');
            featureIcons.forEach(icon => {
                const parent = icon.parentElement;
                if (parent && parent.style.borderRadius) {
                    parent.style.border = `2px solid ${color}`;
                }
            });
            
            // Add color change animation
            addColorChangeEffect(color);
        }
        
        // --- Add Interactive Elements ---
        function addInteractiveElements() {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Make navigation items clickable with hover effects
            const navItems = previewContent.querySelectorAll('nav span');
            navItems.forEach(item => {
                item.style.cursor = 'pointer';
                item.addEventListener('mouseenter', function() {
                    this.style.color = '#3abbfa';
                    this.style.transform = 'scale(1.1)';
                    this.style.transition = 'all 0.2s ease';
                });
                item.addEventListener('mouseleave', function() {
                    this.style.color = '';
                    this.style.transform = 'scale(1)';
                });
            });
            
            // Make buttons interactive
            const buttons = previewContent.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 150);
                });
            });
            
            // Add hover effects to feature cards
            const featureCards = previewContent.querySelectorAll('div[style*="text-align: center"]');
            featureCards.forEach(card => {
                if (card.querySelector('div[style*="font-size: 48px"]')) {
                    card.style.cursor = 'pointer';
                    card.style.transition = 'all 0.3s ease';
                    card.addEventListener('mouseenter', function() {
                        this.style.transform = 'translateY(-5px)';
                        this.style.boxShadow = '0 8px 25px rgba(0,0,0,0.15)';
                    });
                    card.addEventListener('mouseleave', function() {
                        this.style.transform = 'translateY(0)';
                        this.style.boxShadow = '';
                    });
                }
            });
        }
        
        // --- Add Color Change Effect ---
        function addColorChangeEffect(color) {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Create a temporary overlay for color transition
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: ${color};
                opacity: 0.1;
                pointer-events: none;
                z-index: 10;
                animation: colorFlash 0.5s ease-out;
            `;
            
            previewContent.style.position = 'relative';
            previewContent.appendChild(overlay);
            
            setTimeout(() => {
                overlay.remove();
            }, 500);
        }
        
        // Add color flash animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes colorFlash {
                0% { opacity: 0.3; }
                100% { opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // --- Add Real-time Counter Animations ---
        function animateCounters() {
            const counters = document.querySelectorAll('.analytics-section div[style*="font-size: 36px"]');
            counters.forEach(counter => {
                const target = parseInt(counter.textContent.replace(/[^\d]/g, ''));
                const suffix = counter.textContent.replace(/[\d]/g, '');
                let current = 0;
                const increment = target / 50;
                
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    counter.textContent = Math.floor(current) + suffix;
                }, 20);
            });
        }
        
        // --- Add Loading States ---
        function addLoadingState(element) {
            element.style.opacity = '0.7';
            element.style.pointerEvents = 'none';
            
            const spinner = document.createElement('div');
            spinner.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 20px;
                height: 20px;
                border: 2px solid #f3f3f3;
                border-top: 2px solid #3abbfa;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                z-index: 100;
            `;
            
            element.style.position = 'relative';
            element.appendChild(spinner);
            
            setTimeout(() => {
                element.style.opacity = '1';
                element.style.pointerEvents = 'auto';
                spinner.remove();
            }, 1000);
        }
        
        // Add spin animation
        const spinStyle = document.createElement('style');
        spinStyle.textContent = `
            @keyframes spin {
                0% { transform: translate(-50%, -50%) rotate(0deg); }
                100% { transform: translate(-50%, -50%) rotate(360deg); }
            }
        `;
        document.head.appendChild(spinStyle);
        
        // --- Enhanced Form Interactions ---
        document.getElementById('wizardForm').addEventListener('mouseover', function(e) {
            const target = e.target;
            if (target.tagName === 'LABEL' && target.closest('.space-y-2')) {
                target.style.backgroundColor = 'rgba(58, 187, 250, 0.1)';
                target.style.borderRadius = '8px';
                target.style.transition = 'background-color 0.3s ease';
                target.style.transform = 'translateX(5px)';
            }
        });
        
        document.getElementById('wizardForm').addEventListener('mouseout', function(e) {
            const target = e.target;
            if (target.tagName === 'LABEL' && target.closest('.space-y-2')) {
                target.style.backgroundColor = '';
                target.style.borderRadius = '';
                target.style.transform = 'translateX(0)';
            }
        });
        
        // Add dynamic form validation feedback
        document.getElementById('wizardForm').addEventListener('change', function(e) {
            const target = e.target;
            
            // Checkbox animations
            if (target.type === 'checkbox') {
                const label = target.closest('label');
                if (target.checked) {
                    label.style.background = 'rgba(58, 187, 250, 0.15)';
                    label.style.borderColor = '#3abbfa';
                    label.style.transform = 'scale(1.05)';
                    setTimeout(() => {
                        label.style.transform = 'scale(1)';
                    }, 200);
                    
                    // Add checkmark animation
                    const checkmark = document.createElement('span');
                    checkmark.innerHTML = '‚úì';
                    checkmark.style.cssText = `
                        position: absolute;
                        right: 10px;
                        top: 50%;
                        transform: translateY(-50%);
                        color: #3abbfa;
                        font-weight: bold;
                        font-size: 18px;
                        animation: checkmarkIn 0.3s ease;
                    `;
                    label.style.position = 'relative';
                    label.appendChild(checkmark);
                    
                    setTimeout(() => {
                        checkmark.remove();
                    }, 1000);
                } else {
                    label.style.background = '';
                    label.style.borderColor = '';
                }
            }
            
            // Radio button animations
            if (target.type === 'radio') {
                const name = target.name;
                const otherRadios = document.querySelectorAll(`input[name="${name}"]`);
                otherRadios.forEach(r => {
                    const rLabel = r.closest('label');
                    if (rLabel) {
                        rLabel.style.background = '';
                        rLabel.style.borderColor = '';
                    }
                });
                
                const label = target.closest('label');
                if (label) {
                    label.style.background = 'rgba(58, 187, 250, 0.15)';
                    label.style.borderColor = '#3abbfa';
                    label.style.transform = 'scale(1.05)';
                    setTimeout(() => {
                        label.style.transform = 'scale(1)';
                    }, 200);
                }
            }
            
            // Color picker preview
            if (target.type === 'color') {
                const preview = document.getElementById('sitePreview');
                if (preview) {
                    preview.style.borderColor = target.value;
                    preview.style.transition = 'border-color 0.3s ease';
                    
                    // Add color change indicator
                    const indicator = document.createElement('div');
                    indicator.style.cssText = `
                        position: absolute;
                        top: 10px;
                        right: 10px;
                        width: 20px;
                        height: 20px;
                        background: ${target.value};
                        border-radius: 50%;
                        border: 2px solid white;
                        animation: colorPulse 0.5s ease;
                    `;
                    preview.appendChild(indicator);
                    
                    setTimeout(() => {
                        indicator.remove();
                    }, 1000);
                }
            }
        });
        
        // Add checkmark animation
        const checkmarkStyle = document.createElement('style');
        checkmarkStyle.textContent = `
            @keyframes checkmarkIn {
                from { 
                    opacity: 0; 
                    transform: translateY(-50%) scale(0); 
                }
                to { 
                    opacity: 1; 
                    transform: translateY(-50%) scale(1); 
                }
            }
            
            @keyframes colorPulse {
                0% { transform: scale(0); opacity: 0; }
                50% { transform: scale(1.2); opacity: 1; }
                100% { transform: scale(1); opacity: 0; }
            }
        `;
        document.head.appendChild(checkmarkStyle);

        // --- Combined Form Click Handler ---
    document.getElementById('wizardForm').addEventListener('click', function(e) {
            const target = e.target;
            
            if (target.dataset.action === 'next') {
                // Add animation
                target.style.transform = 'scale(0.95)';
                target.style.background = '#2a9ee0';
                target.innerHTML = '‚úì Processing...';
                
                setTimeout(() => {
                    target.style.transform = 'scale(1)';
                    target.style.background = '#3abbfa';
                    target.innerHTML = 'Continue';
                    nextStep();
                }, 500);
                return;
            }
            
            if (target.dataset.action === 'back') {
                prevStep();
                return;
            }
            
            if (target.dataset.action === 'download') {
            const dataStr = JSON.stringify(formData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'creative-brief-summary.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
                return;
        }
            
            if (target.dataset.action === 'submit') {
            // Submit to Formspree
            const form = document.createElement('form');
            form.action = 'https://formspree.io/f/your-form-id'; // TODO: Replace with your Formspree endpoint
            form.method = 'POST';
            form.style.display = 'none';
            for (const key in formData) {
                if (formData.hasOwnProperty(key)) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = typeof formData[key] === 'object' ? JSON.stringify(formData[key]) : formData[key];
                    form.appendChild(input);
                }
            }
            if (formData.email) {
                const cc = document.createElement('input');
                cc.type = 'hidden';
                cc.name = '_cc';
                cc.value = formData.email;
                form.appendChild(cc);
            }
            document.body.appendChild(form);
            form.submit();
            document.body.removeChild(form);
                return;
            }
        });

        // --- Real-time Progress Tracking ---
        function updateProgressIndicator() {
            const totalFields = 8; // Total number of form sections
            let completedFields = 0;
            
            // Check each section for completion
            if (formData.businessType) completedFields++;
            if (formData.goals && formData.goals.length > 0) completedFields++;
            if (formData.pagesCore && formData.pagesCore.length > 0) completedFields++;
            if (formData.pagesTrust && formData.pagesTrust.length > 0) completedFields++;
            if (formData.pagesEngage && formData.pagesEngage.length > 0) completedFields++;
            if (formData.pagesCommerce && formData.pagesCommerce.length > 0) completedFields++;
            if (formData.features && formData.features.length > 0) completedFields++;
            if (formData.designStyle) completedFields++;
            if (formData.primaryColor) completedFields++;
            
            const progressPercentage = Math.min((completedFields / totalFields) * 100, 100);
            
            // Update progress bar
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = `${progressPercentage}%`;
                progressBar.style.transition = 'width 0.5s ease';
            }
            
            // Add completion celebration
            if (progressPercentage === 100) {
                addCompletionCelebration();
            }
        }
        
        // --- Add Completion Celebration ---
        function addCompletionCelebration() {
            const preview = document.getElementById('sitePreview');
            const previewContent = preview.querySelector('.preview-content');
            
            // Create celebration overlay
            const celebration = document.createElement('div');
            celebration.style.cssText = `
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(45deg, rgba(58, 187, 250, 0.9), rgba(42, 158, 224, 0.9));
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                animation: celebrationIn 0.5s ease;
            `;
            
            celebration.innerHTML = `
                <div style="text-align: center; color: white;">
                    <div style="font-size: 48px; margin-bottom: 16px;">üéâ</div>
                    <h3 style="font-size: 24px; margin-bottom: 8px;">Perfect!</h3>
                    <p style="font-size: 16px; opacity: 0.9;">Your site configuration is complete!</p>
                </div>
            `;
            
            previewContent.style.position = 'relative';
            previewContent.appendChild(celebration);
            
            setTimeout(() => {
                celebration.style.animation = 'celebrationOut 0.5s ease';
                setTimeout(() => {
                    celebration.remove();
                }, 500);
            }, 2000);
        }
        
        // Add celebration animations
        const celebrationStyle = document.createElement('style');
        celebrationStyle.textContent = `
            @keyframes celebrationIn {
                from { 
                    opacity: 0; 
                    transform: scale(0.8); 
                }
                to { 
                    opacity: 1; 
                    transform: scale(1); 
                }
            }
            
            @keyframes celebrationOut {
                from { 
                    opacity: 1; 
                    transform: scale(1); 
                }
                to { 
                    opacity: 0; 
                    transform: scale(0.8); 
                }
            }
        `;
        document.head.appendChild(celebrationStyle);
        
    // --- Initial Render ---
        initializeFormData();
    renderStep(currentStep);
        updatePreview();
        
        // Update progress on form changes
        document.getElementById('wizardForm').addEventListener('input', function() {
            updateProgressIndicator();
        });
    </script>
</body>
</html> 